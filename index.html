<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>Title</title>
    <link href="dist/output.css" rel="stylesheet" />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-lg shadow-md py-2 bg-white relative flex items-center w-full justify-between">
        <div class="px-6 w-full flex flex-wrap items-center justify-between">
          <div class="navbar-collapse collapse grow items-center" id="navbarSupportedContentY">
            <ul class="navbar-nav mr-auto lg:flex lg:flex-row">
              <li class="nav-item">
                <a
                  class="nav-link block pr-2 lg:px-2 py-2 font-bold text-gray-600 hover:text-gray-700 focus:text-gray-700 transition duration-150 ease-in-out"
                  data-mdb-ripple="true"
                  data-mdb-ripple-color="light"
                  href="/"
                  >Zoom振り分けくん</a
                >
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

    <div class="container">
      <div class="mt-3">
        <form action="" class="form-group" id="form-group" method="post">
          <div class="form-group-num">
            <label for="group-num">ブレイクアウトルームの数</label>
            <input
              class="group-num focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md"
              id="group-num"
              required
              type="text"
            />
          </div>
          <div class="form-submit mt-2">
            <input
              class="py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"
              type="submit"
              value="振り分け！"
            />
          </div>
        </form>
      </div>
    </div>

    <script>
      let groupId = 0;
      let nameId = 0;
      let areaId = 0;

      function addGroupForm() {
        const contentArea = document.getElementById('form-group');
        const newFromAttributeGroup = document.createElement('div');
        groupId++;
        nameId++;
        areaId++;
        newFromAttributeGroup.setAttribute('id', `form-group-${groupId}`);
        newFromAttributeGroup.className = 'mt-3 p-3 bg-gray-50 rounded-md shadow sm:rounded-md sm:overflow-hidden';
        newFromAttributeGroup.innerHTML = `
      <div class='col-span-6 sm:col-span-4'>
        <label for='element'>属性</label>
        <input
          type='text'
          class='element focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md'
          id='element'
          required
        />
      </div>
      <div id='form-area-${areaId}' class='grid grid-cols-3 gap-6'>
        <div id='form-input-info-${nameId}' class='form-group'>
          <div class='mt-2'>
            <div>
              <label for='element'>名前</label>
              <input
                type='text'
                class='name group-num focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md'
                id='name'
                required
              />
            </div>
            <div class='mt-1'>
              <label for='element'>Zoomのメールアドレス</label>
              <input
                type='text'
                class='email focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md'
                id='email'
                required
              />
            </div>
          </div>
          <div class='mt-3'>
            <input
              type='button'
              class='bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
              value='＋'
              onclick="addInputInfo('form-area-${areaId}')"
            />
            <input
              type='button'
              class='bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
              value='－'
              onclick="deleteElement('form-input-info-${nameId}')"
            />
          </div>
        </div>
      </div>
      <div class='mt-3'>
        <input
          type='button'
          class='bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
          value='属性を追加'
          onclick='addGroupForm()'
        />
        <input
          type='button'
          class='bg-red-600 py-2 px-3 border border-transparent rounded-md shadow-sm text-sm leading-4 font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500'
          value='属性を削除'
          onclick="deleteElement('form-group-${groupId}')"
        />
      </div>
    `;
        contentArea.appendChild(newFromAttributeGroup);
      }

      function deleteElement(idName) {
        const contentArea = document.getElementById(idName);
        contentArea.remove();
      }

      function addInputInfo(addAreaId) {
        const contentArea = document.getElementById(addAreaId);
        const newFromAttributeGroup = document.createElement('div');
        nameId++;
        newFromAttributeGroup.setAttribute('id', `form-input-info-${nameId}`);
        newFromAttributeGroup.innerHTML = `
          <div class='mt-2'>
            <div>
              <label for='element'>名前</label>
              <input
                type='text'
                class='name group-num focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md'
                id='name'
                required
              />
            </div>
            <div class='mt-1'>
              <label for='element'>Zoomのメールアドレス</label>
              <input
                type='text'
                class='email focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md'
                id='email'
                required
              />
            </div>
          </div>
          <div class='mt-3'>
            <input
              type='button'
              class='bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
              value='＋'
              onclick="addInputInfo('form-area-${areaId}')"
            />
            <input
              type='button'
              class='bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500'
              value='－'
              onclick="deleteElement('form-input-info-${nameId}')"
            />
          </div>
    `;
        contentArea.appendChild(newFromAttributeGroup);
      }

      window.addEventListener('DOMContentLoaded', function () {
        addGroupForm();

        // HTML要素を取得
        let formGroup = document.getElementById('form-group');

        // submitを待っている
        formGroup.addEventListener('submit', function (e) {
          // グループの数を表示
          const groupNum = document.getElementsByClassName('group-num');
          console.log('グループ数 = ' + groupNum[0].value);

          // 属性の表示
          const elementList = document.getElementsByClassName('element');
          for (let i = 0; i < elementList.length; i++) {
            console.log(i + 'つ目の属性 = ' + elementList[i].value);
          }

          // 人の名前の表示
          const nameList = document.getElementsByClassName('name');
          for (let i = 0; i < nameList.length; i++) {
            console.log(i + '人目の名前 = ' + nameList[i].value);
          }

          // メアドの表示
          const emailList = document.getElementsByClassName('email');
          for (let i = 0; i < emailList.length; i++) {
            console.log(i + '人目のメアド = ' + emailList[i].value);
          }

          // デバッグ時ページが更新されないようにイベントを止める
          e.preventDefault();
        });
      });
    </script>
  </body>
</html>
